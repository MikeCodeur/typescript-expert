# Les d√©corators

### üí° Comprendre les decorators

## üìù Tes notes

Detaille ce que tu as appris ici
`src/exercise/01.md`ou¬†sur¬†une¬†page¬†[Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Les d√©corators sont encore exp√©rimentales mais ils devraient normalement √™tre
standardiser prochainement. Cela existe depuis tr√®s longtemps dans d‚Äôautre
langages comme Java. Ils fonctionnent avec des Annotations (sur les classes et
membres de classes).

```tsx
function first() {
  console.log('first(): factory evaluated')
  return function (
    target: any,
    propertyKey: string,
    descriptor: PropertyDescriptor,
  ) {
    console.log('first(): called')
  }
}

function second() {
  console.log('second(): factory evaluated')
  return function (
    target: any,
    propertyKey: string,
    descriptor: PropertyDescriptor,
  ) {
    console.log('second(): called')
  }
}

class ExampleClass {
  @first()
  @second()
  method() {}
}
```

Il faut ajouter dans la configuration

```json
{
  "compilerOptions": {
    "target": "ES5",
    "experimentalDecorators": true
  }
}
```

## Exercice

Nous allons voir les decorateurs de classe.

Nous avons ici la classe Book

```tsx
class Book {
  type = 'pdf'
  title: string

  constructor(t: string) {
    this.title = t
  }
}
const book = new Book('Harry Potter')
const book2 = new Book('La semaine de 4h')
```

Il est possible d‚Äô√©tendre Book en faisant

```tsx
Book.constructor = () => {}
```

Pour √©viter cela on peut utiliser
[`Object.](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze)seal`

```tsx
class Book {
  type = 'pdf'
  title: string

  constructor(t: string) {
    this.title = t
  }
  getName() {
    return this.title
  }
}
Object.seal(Book.constructor)
```

Il faudrait r√©p√©ter cela sur toutes les classes de notre code. Un m√©thode
possible est de cr√©er un d√©corateur de classe `@sealed` qui interdit cela et qui
s‚Äôutiliserait

```tsx
@sealed
class Book {
 ...
}
function sealed(constructor: Function) {
  ...
}
```

Cr√©er le d√©corateur `sealed` et utilise le

## Bonus

### 1. üöÄ D√©corateur de m√©thodes avec param

Nous voulons maintenant pourvoir g√©rer le fait de pouvoir √©num√©rer ou non les
m√©thodes des instances de classes : cela se fait en d√©finissant la propri√©t√©
`enumerable`

Quand un `object` est `enumerable` on peut lister ses propri√©t√©s

```tsx
for (let key in book) {
  console.log('key Book', key) // type , title, getName
}
```

[lien vers doc](https://javascript.info/property-descriptors#non-enumerable)

Nous allons donc cr√©er un d√©corateur `@enumerable(true)`

```tsx
function enumerable(value: boolean) {
  console.log('enumerable(): factory evaluated')
  return function (
    target: any,
    propertyKey: string,
    descriptor: PropertyDescriptor,
  ) {
    descriptor.enumerable = value
  }
}
```

applique ce d√©corateur sur la m√©thode `getName` tel que

```tsx
@enumerable(true)  // type , title, getName
@enumerable(false) // type , title
```

## Aller plus loin

üìë Le liens vers la doc
[https://www.typescriptlang.org/docs/handbook/decorators.html](https://www.typescriptlang.org/docs/handbook/decorators.html)

## üêú Feedback

Remplir le formulaire le
[formulaire de FeedBack](https://go.mikecodeur.com/cours-react-avis?entry.1912869708=TypeScript%20PRO&entry.1430994900=2.Les%20Fondamentaux&entry.533578441=01%20Les%20bases).
